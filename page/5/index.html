<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>流水易寒の博客</title><meta name="author" content="姬岚忧"><meta name="copyright" content="姬岚忧"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="不想做开发的运维，不是好运维"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202212290947085.png"><link rel="canonical" href="https://blog.kkun.site/page/5/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="zEdV2SVm14BBjmysMbimJptVuSESoCKhQvg2KGyh3tM"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-5936787105308700',
  enable_page_level_ads: 'true'
});</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-RRJTLY81FN"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-RRJTLY81FN');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '流水易寒の博客',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-10-24 10:37:08'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/logo.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">80</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">43</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">39</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文章目录</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://github.com/Ghostpanter"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202212290952165.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">流水易寒の博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文章目录</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://github.com/Ghostpanter"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">流水易寒の博客</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/Ghostpanter" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:18816230062qk@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2023/02/14/%E4%BC%98%E5%8C%96Docker%E9%95%9C%E5%83%8F%E5%A4%A7%E5%B0%8F/" title="优化Docker镜像的10个技巧"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202302141438966.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="优化Docker镜像的10个技巧"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/14/%E4%BC%98%E5%8C%96Docker%E9%95%9C%E5%83%8F%E5%A4%A7%E5%B0%8F/" title="优化Docker镜像的10个技巧">优化Docker镜像的10个技巧</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-14T06:47:51.000Z" title="发表于 2023-02-14 14:47:51">2023-02-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Docker/">Docker</a></span></div><div class="content">什么是 docker？Docker 是一种容器引擎，可以在容器内运行一段代码。Docker 镜像是在任何地方运行您的应用程序而无需担心应用程序依赖性的方式。
要构建镜像，docker 使用一个名为 Dockerfile 的文件。Dockerfile 是一个包含许多指令（RUN、COPY、EXPOSE 等）的文件。成功执行这些命令后，docker 将创建一个镜像供我们在任何地方使用。
为什么要减小 docker 镜像大小？
安装不必要的软件包会增加攻击面，从而增加安全风险。
镜像传输需要更多时间。
部署大镜像需要更多时间。

我们必须以某种方式创建我们的 Dockerfile，以便从该 Dockerfile 构建的镜像在大小方面得到优化。
在本文中，我们将讨论 10 种减少 docker 镜像大小的有效方法。
1：最小化镜像层我们可以减少 Dockerfile 中的层数。
dockerfile 中的每个 FROM、RUN、COPY 命令都会创建一个单独的层，并增加镜像的整体大小和构建时间。
要减小 docker 镜像大小，请在单个 RUN 或 COPY 指令中执行多个命令来最小化 Doc ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/02/14/k8s%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF/" title="Kubernetes网络异常排查思路"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202301101650972.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes网络异常排查思路"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/14/k8s%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF/" title="Kubernetes网络异常排查思路">Kubernetes网络异常排查思路</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-14T05:45:33.000Z" title="发表于 2023-02-14 13:45:33">2023-02-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="content">Overview本文将引入一个思路：“在 Kubernetes 集群发生网络异常时如何排查”。文章将引入 Kubernetes 集群中网络排查的思路，包含网络异常模型，常用工具，并且提出一些案例以供学习。

Pod 常见网络异常分类
网络排查工具
Pod 网络异常排查思路及流程模型
CNI 网络异常排查步骤
案例学习

Pod 网络异常网络异常大概分为如下几类：

网络不可达，主要现象为 ping 不通，其可能原因为：

源端和目的端防火墙（iptables, selinux）限制
网络路由配置不正确
源端和目的端的系统负载过高，网络连接数满，网卡队列满
网络链路故障


端口不可达：主要现象为可以 ping 通，但 telnet 端口不通，其可能原因为：

源端和目的端防火墙限制
源端和目的端的系统负载过高，网络连接数满，网卡队列满，端口耗尽
目的端应用未正常监听导致（应用未启动，或监听为 127.0.0.1 等）


DNS 解析异常：主要现象为基础网络可以连通，访问域名报错无法解析，访问 IP 可以正常连通。其可能原因为

Pod 的 DNS 配置不正确
DNS 服务异常
pod ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/02/14/kubectl%E7%9A%84%E5%A4%9A%E6%A0%B7%E7%94%A8%E6%B3%95/" title="kubectl的多样用法"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202301101650972.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kubectl的多样用法"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/14/kubectl%E7%9A%84%E5%A4%9A%E6%A0%B7%E7%94%A8%E6%B3%95/" title="kubectl的多样用法">kubectl的多样用法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-14T05:31:33.000Z" title="发表于 2023-02-14 13:31:33">2023-02-14</time></span></div><div class="content">简述kubectl是K8s官方附带的命令行工具, 可以方便的操作K8s集群. 这篇文章主要介绍一些kubectl的别样用法, 希望读者有基础的K8s使用经验.
打印当前使用的API123# kubectl 的主要作用就是与ApiServer进行交互, 而交互的过程, 我们可以通过下面的方式来打印, # 这个命令尤其适合调试自己的api接口时使用.kubectl get ns -v=9


按状态筛选容器以及删除1234567891011121314151617181920212223242526272829kubectl get pods --all-namespaces --field-selector status.phase=Pending -o json | \  jq &#x27;.items[] | &quot;kubectl delete pods \(.metadata.name) -n \(.metadata.namespace)&quot;&#x27; | \  xargs -n 1 bash -c# 这个命令要拆开来看# 首先, 获取所有ns中状态为Pending ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/02/07/K8S%20OOM%20%E5%92%8C%20CPU%20%E8%8A%82%E6%B5%81/" title="K8S OOM 和 CPU 节流"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202301101650972.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="K8S OOM 和 CPU 节流"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/07/K8S%20OOM%20%E5%92%8C%20CPU%20%E8%8A%82%E6%B5%81/" title="K8S OOM 和 CPU 节流">K8S OOM 和 CPU 节流</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-07T08:38:33.000Z" title="发表于 2023-02-07 16:38:33">2023-02-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="content">介绍使用 Kubernetes 时，内存不足 (OOM) 错误和 CPU 节流是云应用程序中资源处理的主要难题。
这是为什么？
云应用程序中的 CPU 和内存要求变得越来越重要，因为它们与您的云成本直接相关。
通过 limits 和 requests ，您可以配置 pod 应如何分配内存和 CPU 资源，以防止资源匮乏并调整云成本。
如果节点没有足够的资源， Pod 可能会通过抢占或节点压力被驱逐。
当一个进程运行内存不足 (OOM) 时，它会被终止，因为它没有所需的资源。
如果 CPU 消耗高于实际限制，进程将开始节流。
但是，如何主动监控 Kubernetes Pod 到达 OOM 和 CPU 节流的距离有多近？
Kubernetes OOMPod 中的每个容器都需要内存才能运行。
Kubernetes limits 是在 Pod 定义或 Deployment 定义中为每个容器设置的。
所有现代 Unix 系统都有一种方法来终止进程，以防它们需要回收内存。这将被标记为错误 137 或OOMKilled.
1234567State:          Running   Starte ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/02/07/CoreDNS%20%E5%9C%A8%20K8S%20%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8%E5%8F%8A%E7%9B%91%E6%8E%A7/" title="CoreDNS 在 K8S 中的作用及监控"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202302071505193.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CoreDNS 在 K8S 中的作用及监控"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/07/CoreDNS%20%E5%9C%A8%20K8S%20%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8%E5%8F%8A%E7%9B%91%E6%8E%A7/" title="CoreDNS 在 K8S 中的作用及监控">CoreDNS 在 K8S 中的作用及监控</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-07T07:25:33.000Z" title="发表于 2023-02-07 15:25:33">2023-02-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/kubernetes/CoreDns/">CoreDns</a></span></div><div class="content">CoreDNS 在 K8S 中的作用CoreDNS 是 Kubernetes 环境的DNS add-on[1]组件。它是在控制平面节点中运行的组件之一，使其正常运行和响应是 Kubernetes 集群正常运行的关键。学习如何监控 CoreDNS，以及它最重要的指标是什么，对于运维团队来说是必须的。
DNS 是每个体系结构中最敏感和最重要的服务之一。应用程序、微服务、服务、主机……如今，万物互联，并不一定意味着只用于内部服务。它也可以应用于外部服务。DNS 负责解析域名并关联内部或外部服务和 PodIP。维护 Pod 的 DNS 记录是一项关键任务，尤其是涉及到临时 Pod 时，IP 地址可以在没有警告的情况下随时更改。
如果您在 Kubernetes 中运行您的工作负载，并且您不知道如何监控 CoreDNS，请继续阅读本文：如何使用 Prometheus 来抓取 CoreDNS 指标，您应该检查哪些指标，以及它们的含义。
在本文中，我们将涵盖以下主题：

什么是 Kubernetes CoreDNS？
如何在 Kubernetes 中监控 CoreDNS？
监控 Kubernetes  ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/02/07/kubernetes%E5%90%8D%E8%AF%8D%E7%BC%A9%E5%86%99/" title="kubernetes各名词缩写"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202301101650972.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kubernetes各名词缩写"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/07/kubernetes%E5%90%8D%E8%AF%8D%E7%BC%A9%E5%86%99/" title="kubernetes各名词缩写">kubernetes各名词缩写</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-07T06:54:33.000Z" title="发表于 2023-02-07 14:54:33">2023-02-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="content">kubernetes各名词缩写


NAME
SHORTNAMES
APIGROUP
NAMESPACED
KIND



bindings


true
Binding


componentstatuses
cs

false
ComponentStatus


configmaps
cm

true
ConfigMap


endpoints
ep

true
Endpoints


events
ev

true
Event


limitranges
limits

true
LimitRange


namespaces
ns

false
Namespace


nodes
no

false
Node


persistentvolumeclaims
pvc

true
PersistentVolumeClaim


persistentvolumes
pv

false
PersistentVolume


pods
po

true
Pod


podtemplates


true
PodTemplate


replicationcontrollers
rc

 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/02/01/%E7%94%A8%20Ansible%20%E7%AE%80%E5%8C%96%20K8S%20%E9%83%A8%E7%BD%B2/" title="用 Ansible 简化 K8S 部署"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202301290855399.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="用 Ansible 简化 K8S 部署"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/01/%E7%94%A8%20Ansible%20%E7%AE%80%E5%8C%96%20K8S%20%E9%83%A8%E7%BD%B2/" title="用 Ansible 简化 K8S 部署">用 Ansible 简化 K8S 部署</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-01T02:28:55.000Z" title="发表于 2023-02-01 10:28:55">2023-02-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/kubernetes/Ansible/">Ansible</a></span></div><div class="content">一、概述前面我写了关于k8s环境部署的几篇文章，k8s部署还是比较麻烦的，所以是有必要考虑一键部署的方案，这里借助ansible playbook来实现k8s环境的一键部署，实现快速部署的目的。
节点信息



主机名
IP
角色
操作系统



local-168-182-110
192.168.182.110
master，ansible
centos7


local-168-182-111
192.168.182.110
master
centos7


local-168-182-112
192.168.182.110
master
centos7


local-168-182-113
192.168.182.110
node
centos7


k8s 架构图：

基于ansible部署k8s流程图：

二、Ansible 部署123yum -y install epel-releaseyum -y install ansibleansible --version

1）开启记录日志配置文件：/etc/ansible/ansible.cfg
123vi /etc/ansi ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/01/31/nginx%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88/" title="Nginx高可用方案"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202302011332011.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nginx高可用方案"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/31/nginx%E9%AB%98%E5%8F%AF%E7%94%A8%E6%96%B9%E6%A1%88/" title="Nginx高可用方案">Nginx高可用方案</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-31T05:42:51.000Z" title="发表于 2023-01-31 13:42:51">2023-01-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Linux/">Linux</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Linux/Nginx/">Nginx</a></span></div><div class="content">准备工作192.168.16.128
192.168.16.129
两台虚拟机。安装好Nginx
安装Nginx更新yum源文件：
12rpm -ivh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpmwget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo

安装Nginx:
1yum -y install  nginx

操作命令：
12systemctl start nginx; #启动Nginxsystemctl stop nginx; #停止Nginx

什么是高可用？高可用HA（High Availability）是分布式系统架构设计中必须考虑的因素之一，它通常是指，通过设计减少系统不能提供服务的时间。如果一个系统能够一直提供服务，那么这个可用性则是百分之百，但是天有不测风云。所以我们只能尽可能的去减少服务的故障。
解决的问题？在 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/01/29/linux%E7%99%BB%E5%BD%95%E8%B6%85%E6%AC%A1%E6%95%B0%E8%87%AA%E5%8A%A8%E6%8B%89%E9%BB%91/" title="Linux SSH 登录错误超时次数自动加入ip黑名单"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/75385594_p0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux SSH 登录错误超时次数自动加入ip黑名单"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/29/linux%E7%99%BB%E5%BD%95%E8%B6%85%E6%AC%A1%E6%95%B0%E8%87%AA%E5%8A%A8%E6%8B%89%E9%BB%91/" title="Linux SSH 登录错误超时次数自动加入ip黑名单">Linux SSH 登录错误超时次数自动加入ip黑名单</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-29T07:36:53.000Z" title="发表于 2023-01-29 15:36:53">2023-01-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Linux/">Linux</a></span></div><div class="content">Linux 系统SSH 登录失败的内容会记录到&#x2F;var&#x2F;log&#x2F;secure文件，通过查找关键字 Failed，可以定位到这些异常的IP地址，比如：
12[root@ghost ~]# cat /var/log/secure |grep Failed               #查看所有的异常IP[root@ghost ~]# cat /var/log/secure |grep 181.204.166.58       #查看指定的异常IP

相关文件 ：&#x2F;etc&#x2F;hosts.deny 禁止哪些IP访问主机:
1[root@ghost ~]# cat /etc/hosts.deny

因此，我们只需要从&#x2F;var&#x2F;log&#x2F;secure文件中提取IP地址，如果次数达到10次则将该IP写到 &#x2F;etc&#x2F;hosts.deny中，禁止这些IP访问主机。
脚本如下secure_ssh.sh：
123456789101112131415[root@ghost tmp]# vim secure_ssh. ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/01/29/Ansible%20playbook%20%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%93%8D%E4%BD%9C/" title="Ansible playbook 介绍与操作"><img class="post_bg" src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202301290855399.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ansible playbook 介绍与操作"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/29/Ansible%20playbook%20%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%93%8D%E4%BD%9C/" title="Ansible playbook 介绍与操作">Ansible playbook 介绍与操作</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-29T00:56:55.000Z" title="发表于 2023-01-29 08:56:55">2023-01-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Ansible/">Ansible</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/Ansible/playbook/">playbook</a></span></div><div class="content">一、概述
playbook 与 ad-hoc 相比,是一种完全不同的运用 ansible 的方式，类似与 saltstack 的 state 状态文件。ad-hoc 无法持久使用，playbook 可以持久使用。
playbook 是由一个或多个 play 组成的列表，play 的主要功能在于将事先归并为一组的主机装扮成事先通过 ansible 中的 task 定义好的角色。
从根本上来讲，所谓的 task 无非是调用 ansible 的一个 module。将多个 play 组织在一个 playbook 中，即可以让它们联合起来按事先编排的机制完成某一任务。

参考文档：https://ansible-tran.readthedocs.io/en/latest/docs/playbooks.html
Ansible 的基础介绍和环境部署可以参考这篇文章：

二、playbook 核心元素
Hosts 执行的远程主机列表
Tasks 任务集
Varniables 内置变量或自定义变量在 playbook 中调用
Templates 模板，即使用模板语法的文件，比如配置文件等
Handle ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/4/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/#content-inner">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/#content-inner">8</a><a class="extend next" rel="next" href="/page/6/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/logo.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">姬岚忧</div><div class="author-info__description">不想做开发的运维，不是好运维</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">80</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">43</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">39</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Ghostpanter"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Ghostpanter" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:18816230062qk@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/10/24/K8s%20%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8%E6%B5%81%E7%A8%8B/" title="K8s 持久化存储流程"><img src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202301101650972.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="K8s 持久化存储流程"/></a><div class="content"><a class="title" href="/2023/10/24/K8s%20%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8%E6%B5%81%E7%A8%8B/" title="K8s 持久化存储流程">K8s 持久化存储流程</a><time datetime="2023-10-24T02:29:33.000Z" title="发表于 2023-10-24 10:29:33">2023-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/11/OpenTelemetry/" title="无题"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/77495593_p0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2023/09/11/OpenTelemetry/" title="无题">无题</a><time datetime="2023-09-11T00:36:33.318Z" title="发表于 2023-09-11 08:36:33">2023-09-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/07/Docker%E5%92%8CContainerd%E7%9A%84%E5%8C%BA%E5%88%AB/" title="Docker与Containerd的区别"><img src="https://imgapi.xl0408.top/index.php" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker与Containerd的区别"/></a><div class="content"><a class="title" href="/2023/09/07/Docker%E5%92%8CContainerd%E7%9A%84%E5%8C%BA%E5%88%AB/" title="Docker与Containerd的区别">Docker与Containerd的区别</a><time datetime="2023-09-07T01:38:51.000Z" title="发表于 2023-09-07 09:38:51">2023-09-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/28/%E4%BD%BF%E7%94%A8%20OpenTelemetry%20Collector%20%E6%94%B6%E9%9B%86%20Kubernetes%20%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE/" title="使用 OpenTelemetry Collector 收集 Kubernetes 日志数据"><img src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202308280847173.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 OpenTelemetry Collector 收集 Kubernetes 日志数据"/></a><div class="content"><a class="title" href="/2023/08/28/%E4%BD%BF%E7%94%A8%20OpenTelemetry%20Collector%20%E6%94%B6%E9%9B%86%20Kubernetes%20%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE/" title="使用 OpenTelemetry Collector 收集 Kubernetes 日志数据">使用 OpenTelemetry Collector 收集 Kubernetes 日志数据</a><time datetime="2023-08-28T02:52:55.000Z" title="发表于 2023-08-28 10:52:55">2023-08-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/28/%E4%BD%BF%E7%94%A8OpenTelemetry%20Collector%E9%87%87%E9%9B%86Kubernetes%E6%8C%87%E6%A0%87%E6%95%B0%E6%8D%AE/" title="使用 OpenTelemetry Collector 采集 Kubernetes 指标数据"><img src="https://raw.gitmirror.com/Ghostpanter/tuchuang/main/img/202308280933314.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 OpenTelemetry Collector 采集 Kubernetes 指标数据"/></a><div class="content"><a class="title" href="/2023/08/28/%E4%BD%BF%E7%94%A8OpenTelemetry%20Collector%E9%87%87%E9%9B%86Kubernetes%E6%8C%87%E6%A0%87%E6%95%B0%E6%8D%AE/" title="使用 OpenTelemetry Collector 采集 Kubernetes 指标数据">使用 OpenTelemetry Collector 采集 Kubernetes 指标数据</a><time datetime="2023-08-28T01:52:55.000Z" title="发表于 2023-08-28 09:52:55">2023-08-28</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Ansible/"><span class="card-category-list-name">Ansible</span><span class="card-category-list-count">2</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Ansible/playbook/"><span class="card-category-list-name">playbook</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Ceph/"><span class="card-category-list-name">Ceph</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CubeFS/"><span class="card-category-list-name">CubeFS</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CubeFS/ClickHouse/"><span class="card-category-list-name">ClickHouse</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Docker/"><span class="card-category-list-name">Docker</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Linux/"><span class="card-category-list-name">Linux</span><span class="card-category-list-count">11</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Linux/DNS/"><span class="card-category-list-name">DNS</span><span class="card-category-list-count">1</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Ansible/" style="font-size: 1.24em; color: rgb(160, 104, 21)">Ansible</a><a href="/tags/playbook/" style="font-size: 1.15em; color: rgb(104, 5, 187)">playbook</a><a href="/tags/kubernetes/" style="font-size: 1.45em; color: rgb(21, 60, 6)">kubernetes</a><a href="/tags/CICD/" style="font-size: 1.19em; color: rgb(31, 41, 184)">CICD</a><a href="/tags/Gitlab/" style="font-size: 1.15em; color: rgb(10, 91, 190)">Gitlab</a><a href="/tags/CGroups/" style="font-size: 1.15em; color: rgb(166, 117, 38)">CGroups</a><a href="/tags/Ceph/" style="font-size: 1.32em; color: rgb(181, 170, 8)">Ceph</a><a href="/tags/CoreDns/" style="font-size: 1.15em; color: rgb(116, 47, 14)">CoreDns</a><a href="/tags/etcd/" style="font-size: 1.19em; color: rgb(34, 89, 110)">etcd</a><a href="/tags/CubeFS/" style="font-size: 1.15em; color: rgb(3, 55, 172)">CubeFS</a><a href="/tags/ClickHouse/" style="font-size: 1.15em; color: rgb(82, 33, 8)">ClickHouse</a><a href="/tags/Docker/" style="font-size: 1.36em; color: rgb(183, 46, 194)">Docker</a><a href="/tags/Linux/" style="font-size: 1.41em; color: rgb(116, 194, 139)">Linux</a><a href="/tags/Jenkins/" style="font-size: 1.15em; color: rgb(86, 103, 135)">Jenkins</a><a href="/tags/Grafana/" style="font-size: 1.28em; color: rgb(8, 113, 72)">Grafana</a><a href="/tags/Tempo/" style="font-size: 1.19em; color: rgb(122, 39, 101)">Tempo</a><a href="/tags/OpenKruise/" style="font-size: 1.28em; color: rgb(46, 62, 196)">OpenKruise</a><a href="/tags/MAC/" style="font-size: 1.15em; color: rgb(192, 163, 155)">MAC</a><a href="/tags/OpenCore/" style="font-size: 1.15em; color: rgb(143, 154, 11)">OpenCore</a><a href="/tags/Ubuntu/" style="font-size: 1.15em; color: rgb(9, 172, 40)">Ubuntu</a><a href="/tags/Prometheus/" style="font-size: 1.15em; color: rgb(1, 108, 106)">Prometheus</a><a href="/tags/Harbor/" style="font-size: 1.24em; color: rgb(16, 58, 137)">Harbor</a><a href="/tags/Minio/" style="font-size: 1.19em; color: rgb(18, 50, 37)">Minio</a><a href="/tags/NFS/" style="font-size: 1.24em; color: rgb(74, 126, 124)">NFS</a><a href="/tags/Helm/" style="font-size: 1.19em; color: rgb(131, 9, 123)">Helm</a><a href="/tags/ingress/" style="font-size: 1.19em; color: rgb(13, 51, 115)">ingress</a><a href="/tags/kubectl/" style="font-size: 1.15em; color: rgb(170, 115, 56)">kubectl</a><a href="/tags/Kubelet/" style="font-size: 1.24em; color: rgb(193, 193, 55)">Kubelet</a><a href="/tags/PDNS/" style="font-size: 1.15em; color: rgb(183, 58, 61)">PDNS</a><a href="/tags/Nginx/" style="font-size: 1.15em; color: rgb(185, 62, 45)">Nginx</a><a href="/tags/PVE/" style="font-size: 1.15em; color: rgb(171, 176, 89)">PVE</a><a href="/tags/Kaniko/" style="font-size: 1.15em; color: rgb(97, 70, 41)">Kaniko</a><a href="/tags/containerd/" style="font-size: 1.15em; color: rgb(128, 99, 132)">containerd</a><a href="/tags/GO/" style="font-size: 1.15em; color: rgb(168, 192, 181)">GO</a><a href="/tags/opentracing/" style="font-size: 1.15em; color: rgb(49, 67, 129)">opentracing</a><a href="/tags/OpenTelemetry-Collector/" style="font-size: 1.19em; color: rgb(58, 113, 51)">OpenTelemetry Collector</a><a href="/tags/Cilium/" style="font-size: 1.15em; color: rgb(154, 20, 134)">Cilium</a><a href="/tags/Kind/" style="font-size: 1.15em; color: rgb(161, 5, 92)">Kind</a><a href="/tags/Mysql/" style="font-size: 1.15em; color: rgb(18, 38, 83)">Mysql</a><a href="/tags/Loki/" style="font-size: 1.19em; color: rgb(43, 115, 45)">Loki</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><span class="card-archive-list-count">13</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><span class="card-archive-list-count">18</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">80</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2022-12-27T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">346.5k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-10-24T02:37:06.655Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202212290952165.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 姬岚忧</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = []
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div><div class="aplayer no-destroy" data-id="8017562763" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '119.60681,31.99260';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>