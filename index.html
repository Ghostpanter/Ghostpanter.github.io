<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>流水易寒の博客</title><meta name="author" content="姬岚忧"><meta name="copyright" content="姬岚忧"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="不想做开发的运维，不是好运维"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202212290947085.png"><link rel="canonical" href="https://blog.kkun.site/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="zEdV2SVm14BBjmysMbimJptVuSESoCKhQvg2KGyh3tM"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-5936787105308700',
  enable_page_level_ads: 'true'
});</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-RRJTLY81FN"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-RRJTLY81FN');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '流水易寒の博客',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-07-28 17:27:52'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/logo.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文章目录</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://github.com/Ghostpanter"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202212290952165.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">流水易寒の博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文章目录</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://github.com/Ghostpanter"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">流水易寒の博客</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/Ghostpanter" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:18816230062qk@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2023/07/28/Kubernetes%20Pod%20%E4%B8%AD%E5%AE%B9%E5%99%A8%E7%9A%84%E5%90%AF%E5%8A%A8%E4%BC%98%E5%85%88%E7%BA%A7/" title="Kubernetes Pod 中容器的启动优先级"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301051001001.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes Pod 中容器的启动优先级"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/28/Kubernetes%20Pod%20%E4%B8%AD%E5%AE%B9%E5%99%A8%E7%9A%84%E5%90%AF%E5%8A%A8%E4%BC%98%E5%85%88%E7%BA%A7/" title="Kubernetes Pod 中容器的启动优先级">Kubernetes Pod 中容器的启动优先级</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-28T09:54:33.000Z" title="发表于 2023-07-28 17:54:33">2023-07-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="content">
今天分享的主题是：怎么控制 Kubernetes 单个 Pod 中容器的启动顺序。
在前面讲容器设计模式时，我曾提到过 Kubernetes Pod 內有两种容器，分别是

Init Container（初始化容器）：在 spec.initContainers 结构体內
Application Container（应用容器）：在 spec.containers 结构体內

Init ContainerInit Container 执行优先于 Application Container，且会按照顺序逐一执行，每个 Init Container 成功终止退出后，下一个 Init Container 才开始执行。
Application Container但是 Application Container 则是完全不一样的，数组內的容器之间是平等无序的。什么意思呢？就是说它们会并行运行，所以我们部署服务时绝不能对容器的顺序做出假设。
我们先来看一个完整的 Pod 的 YMAL 结构，如下所示，全部使用一样的镜像地址：
1234567891011121314151617181920212223 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/07/28/%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86Docker%E5%AE%B9%E5%99%A8%E5%92%8CKubernetes%20Pod%E7%9A%84DNS/" title="如何管理 Docker 容器和 Kubernetes Pod 的 DNS"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301050959939.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何管理 Docker 容器和 Kubernetes Pod 的 DNS"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/28/%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86Docker%E5%AE%B9%E5%99%A8%E5%92%8CKubernetes%20Pod%E7%9A%84DNS/" title="如何管理 Docker 容器和 Kubernetes Pod 的 DNS">如何管理 Docker 容器和 Kubernetes Pod 的 DNS</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-28T03:40:33.000Z" title="发表于 2023-07-28 11:40:33">2023-07-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="content">DNS简介DNS服务是域名系统的缩写， 英文全称：Domain Name System，将域名和IP地址相互映射。在容器环境中，DNS至关重要，例如在Kubernetes集群中，通常一组Pod由一个Service负载，但是Service的IP地址有可能需要变动，那么就可以让Pod通过域名的方式去访问Service，Pod无需理会IP地址的变化。
Docker DNSDocker linkDocker link是一个遗留的特性，在新版本的Docker中，一般不推荐使用。简单来说Docker link就是把两个容器连接起来，容器可以使用容器名进行通信，而不需要依赖ip地址（其实就是在容器的&#x2F;etc&#x2F;hosts文件添加了host记录，原本容器之间的IP就是通的，只是我们增加了host记录，可以不用IP去访问）
创建容器centos-1：
1[root@host1 ~]# docker run -itd --name centos-1  registry.cn-shanghai.aliyuncs.com/public-namespace/cr7-centos7-tool:v ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/07/28/%E4%BC%98%E5%8C%96Kubernetes%20VPA%E7%9A%84%E5%8F%8D%E5%BA%94/" title="优化Kubernetes VPA的反应"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/75368085_p0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="优化Kubernetes VPA的反应"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/28/%E4%BC%98%E5%8C%96Kubernetes%20VPA%E7%9A%84%E5%8F%8D%E5%BA%94/" title="优化Kubernetes VPA的反应">优化Kubernetes VPA的反应</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-28T02:40:33.000Z" title="发表于 2023-07-28 10:40:33">2023-07-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="content">这里是日文版。
几周前，我在苦战优化VPA（Vertical Pod Autoscaler）的性能。我们在公司计划做一个演示，应该有 5 到 10 分钟长，所以默认的 VPA 行为对我们来说太慢了。最终，不得不修改它的源代码，以便在几分钟内动态地改变 pod 的资源请求。
在本文中，我描述了 VPA 的工作原理，以及优化其性能的方法，包括代码修改。
VPA 是什么？VPA，Vertical Pod Autoscaler（垂直 Pod 自动缩放器），使我们能够动态定义资源请求。它观察 pod 的 cpu 和内存利用率，并在运行时更新这些资源请求。
VPA 是如何工作？VPA 由以下三部分组成。

admission-controller（准入控制器）
recommender（推荐器）
updater（更新器）

准入控制器注册许可网络挂钩以修改 pod 的创建请求。
推荐器检查目标 pod 的资源使用情况，并估计推荐的资源请求，然后更新与目标 pod 相关联的 VPA 对象。这个过程定期执行。

更新器检查记录在 VPA 对象中的推荐资源请求，如果目标 pod 的当前资源请求与推荐不匹配 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/07/28/Pod%20%E5%8E%9F%E5%9C%B0%E5%9E%82%E7%9B%B4%E4%BC%B8%E7%BC%A9/" title="Pod 原地垂直伸缩 - 一个四年的KEP和两年的PR"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/84596624_p0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Pod 原地垂直伸缩 - 一个四年的KEP和两年的PR"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/28/Pod%20%E5%8E%9F%E5%9C%B0%E5%9E%82%E7%9B%B4%E4%BC%B8%E7%BC%A9/" title="Pod 原地垂直伸缩 - 一个四年的KEP和两年的PR">Pod 原地垂直伸缩 - 一个四年的KEP和两年的PR</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-28T01:50:33.000Z" title="发表于 2023-07-28 09:50:33">2023-07-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="content">该提案旨在允许 Pod 资源 requests 和 limits 的原地更新，而不需要重新启动 Pod 或其容器，该方案的核心思想是让 PodSpec 的 Resources 是可变的，表示所需的资源，此外 扩展 PodStatus 来反映分配给 Pod 的资源，并提供有关应用于 Pod 及其容器的实际资源信息。

此外该提案还提出了改进容器运行时接口（CRI）API，以便在运行时管理容器的 CPU 和内存资源配置，尝试扩展 UpdateContainerResources 这个 CRI API，使其适用于 Windows 和除 Linux 之外的其他未来的运行时。它还需求扩展 ContainerStatus CRI API，以允许 Kubelet 能够发现当前配置在容器上的资源。
原因由于各种原因，分配给 Pod 的容器资源可能需要变更比，这种场景有很多：

如 Pod 处理的负载大幅增加，而目前的资源不足了
又或者说负载大幅减少了，而分配的资源未被使用
资源配置不合理

目前，更改资源分配是需要重新创建 Pod 的，因为 PodSpec 的容器资源是不可改变的。 虽然许多无状态的工 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/07/28/CGroups%E4%BB%A5%E5%8F%8A%E5%9C%A8K8s%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-IO/" title="CGroups 以及在 K8s 中的应用 - IO"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301051001001.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CGroups 以及在 K8s 中的应用 - IO"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/28/CGroups%E4%BB%A5%E5%8F%8A%E5%9C%A8K8s%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-IO/" title="CGroups 以及在 K8s 中的应用 - IO">CGroups 以及在 K8s 中的应用 - IO</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-28T01:40:33.000Z" title="发表于 2023-07-28 09:40:33">2023-07-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="content">cgroups（control groups，控制组群） 是 Linux 内核的一个功能，用来限制、控制与分离一个进程组的资源（如CPU、内存、磁盘输入输出等）。cgroups到目前为止，有两个大版本， 即 v1 和 v2 。本文针对cgroups对IO的限制能力做简单介绍。
cgroups v1介绍我们当前的测试环境为centos 7.9 ，内核为 5.4版本，如下所示：

cgoups资源限制测试网络IO资源限制tc(Traffic Control)命令tc(Traffic Control) 是linux系统中常用的来控制传输速率、模拟网络延时丢包等场景的工具，tc命令有三个主要的概念，是qdisc、class和filter，qdisc又分为classless qdisc和classful qdisc，在控制传输速度的方面大致有两种用法
（1）对于classless qdisc，可以直接给网络接口直接添加，作为限流的工具
（2）对于classful qdisc，然后class和filter以这个classful qdisc为父节点，其中filter作为过滤器把流量分到具体的clas ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/07/14/CubeFS%E5%8A%A9%E5%8A%9BClickHouse%E5%AD%98%E7%AE%97%E5%88%86%E7%A6%BB/" title="CubeFS助力ClickHouse存算分离"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301051005248.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CubeFS助力ClickHouse存算分离"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/14/CubeFS%E5%8A%A9%E5%8A%9BClickHouse%E5%AD%98%E7%AE%97%E5%88%86%E7%A6%BB/" title="CubeFS助力ClickHouse存算分离">CubeFS助力ClickHouse存算分离</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-14T03:12:51.000Z" title="发表于 2023-07-14 11:12:51">2023-07-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CubeFS/">CubeFS</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/CubeFS/ClickHouse/">ClickHouse</a></span></div><div class="content">01.简介ClickHouse是一个用于关系型联机分析（ROLAP）的列式数据库管理系统（DBMS），擅长PB级数据量的交互式分析。自2016 年开源以来，ClickHouse 凭借其数倍于业界顶尖分析型数据库的极致性能，成为交互式分析领域的后起之秀。CubeFS，则独具创新的设计，与其他产品有较明显的区别：它支持水平扩展的强一致性的元数据服务，提供了副本数弹性可变的多副本存储以及可灵活编码的纠删码存储，此外还支持多级智能加速能力，支持标准S3、POSIX、HDFS三种访问协议，与K8S及容器生态亦有良好兼容性。作为CNCF首个国产开源存储产品，CubeFS吸引了众多社区用户及开发者参与共建，除在OPPO广泛使用外，也已在国内10余家头部企业如京东、网易、贝壳找房、360、魅族、LinkSure网络、Reconova的各个核心业务上落地；部分企业如OPPO、京东、网易、贝壳等使用CubeFS数据规模已达数十PB甚至百PB级。
02.为什么选择CubeFS我们选择CubeFS做冷热分离有以下考虑：

CubeFS提供了比较丰富的接口，支持S3协议， 也可以本地部署client或者嵌入SD ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/07/12/K8s%20%E5%A2%9E%E5%BC%BA%E7%89%88%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%20OpenKruise%20%E4%B9%8B%20CloneSet/" title="K8s 增强版工作负载 OpenKruise 之 CloneSet"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301050959355.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="K8s 增强版工作负载 OpenKruise 之 CloneSet"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/12/K8s%20%E5%A2%9E%E5%BC%BA%E7%89%88%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%20OpenKruise%20%E4%B9%8B%20CloneSet/" title="K8s 增强版工作负载 OpenKruise 之 CloneSet">K8s 增强版工作负载 OpenKruise 之 CloneSet</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-12T06:46:51.000Z" title="发表于 2023-07-12 14:46:51">2023-07-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/kubernetes/OpenKruise/">OpenKruise</a></span></div><div class="content">OpenKruise(https://openkruise.io) 是一个基于 Kubernetes 的扩展套件，主要聚焦于云原生应用的自动化，比如部署、发布、运维以及可用性防护。OpenKruise 提供的绝大部分能力都是基于 CRD 扩展来定义的，它们不存在于任何外部依赖，可以运行在任意纯净的 Kubernetes 集群中。Kubernetes 自身提供的一些应用部署管理功能，对于大规模应用与集群的场景这些功能是远远不够的，OpenKruise 弥补了 Kubernetes 在应用部署、升级、防护、运维等领域的不足。
OpenKruise 提供了以下的一些核心能力：

增强版本的 Workloads：OpenKruise 包含了一系列增强版本的工作负载，比如 CloneSet、Advanced StatefulSet、Advanced DaemonSet、BroadcastJob 等。它们不仅支持类似于 Kubernetes 原生 Workloads 的基础功能，还提供了如原地升级、可配置的扩缩容&#x2F;发布策略、并发操作等。其中，原地升级是一种升级应用容器镜像甚至环境变量的全 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/07/12/%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87RookCeph%E5%8D%87%E7%BA%A7NFS%E6%9C%8D%E5%8A%A1/" title="如何通过Rook/Ceph升级NFS服务"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301101629307.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何通过Rook/Ceph升级NFS服务"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/12/%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87RookCeph%E5%8D%87%E7%BA%A7NFS%E6%9C%8D%E5%8A%A1/" title="如何通过Rook/Ceph升级NFS服务">如何通过Rook/Ceph升级NFS服务</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-12T06:44:38.000Z" title="发表于 2023-07-12 14:44:38">2023-07-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Ceph/">Ceph</a></span></div><div class="content">1. 前言nfs是广泛使用的网络化存储服务，用户基础大，技术成熟，具有操作知识的工程师很多。但是，在云原生和分布式存储的角度看，原生的nfs存储服务不能提供存储高可用能力，然而存储高可用能力是云原生的普遍需求。
本文探索通过ceph为nfs服务提供存储的高可用的可行方案。ceph存储结合nfs-ganesha服务，为nfs客户端提供了基于ceph对象存储的nfs协议输出。ceph提供的存储类型丰富，包括RBD，cephfs，RGW，能够有效满足不同业务场景的需求。本文给出了提供cephfs和RGW两种后端存储机制的nfs集成方案。期望nfs的众多用户可以在云原生环境中继续安心使用熟悉的nfs挂载提供存储能力，而同时获得了ceph存储提供的多副本或者纠删码的高可用特性，满足云原生环境对业务运行的新需求。
本文尝试通过rook(1.10.11)管理的ceph(17.2.5)创建nfs导出，为nfs用户提供一种新的选择和参考。
2. 准备cephfs后端存储2.1  cephfs的一些准备性知识
Volume

Volume是cephfs文件系统的一个抽象。在这个层面可以指定存储使用的cep ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/07/12/OpenKruise%20Cloneset%E4%BD%BF%E7%94%A8/" title="OpenKruise Cloneset 使用"><img class="post_bg" src="http://www.dmoe.cc/random.php" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenKruise Cloneset 使用"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/12/OpenKruise%20Cloneset%E4%BD%BF%E7%94%A8/" title="OpenKruise Cloneset 使用">OpenKruise Cloneset 使用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-12T06:12:51.000Z" title="发表于 2023-07-12 14:12:51">2023-07-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/kubernetes/OpenKruise/">OpenKruise</a></span></div><div class="content">OpenKruise（原名 Kubernetes 增强控制器）是一个 Kubernetes 的扩展框架，它提供了一些新的自定义控制器和 API 所需的 CRD（Custom Resource Definition）来简化应用程序生命周期管理。OpenKruise 旨在帮助开发者更加高效地管理容器应用程序，并支持更丰富、灵活的策略配置。
主要特性如下：

自动水平伸缩：提供了 DaemonSet 集群容器资源限制等高级功能，能够处理特定类型的工作负载并实现自我调整。
灰度发布：通过基于标签的访问控制和路由规则，向指定用户或环境推送应用程序版本部署更新进行测试和验证。
同步升级：支持可以同时定义多个关联对象的应用，实现“熔断”，防止服务时间达到最大值还未响应客户端请求而导致应用中断崩溃。
软件回滚：快速将服务恢复到之前选择正确状态的方法，减少故障对保证稳健运营的影响。

总之，OpenKruise 的目的是为使用 Kubernetes 运行容器的企业提供一个全面的解决方案，使他们可以轻松创建可靠、可扩展、安全和符合要求的应用程序。
openkruise 面向自动化场景的 Kubernete ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/07/11/%E4%BD%BF%E7%94%A8%20OpenKruise%20%E5%A2%9E%E5%BC%BA%20Kubernetes%20%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%E4%B9%8B%20CloneSet/" title="使用 OpenKruise 增强 Kubernetes 工作负载之 CloneSet"><img class="post_bg" src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301051002227.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 OpenKruise 增强 Kubernetes 工作负载之 CloneSet"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/07/11/%E4%BD%BF%E7%94%A8%20OpenKruise%20%E5%A2%9E%E5%BC%BA%20Kubernetes%20%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%E4%B9%8B%20CloneSet/" title="使用 OpenKruise 增强 Kubernetes 工作负载之 CloneSet">使用 OpenKruise 增强 Kubernetes 工作负载之 CloneSet</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-07-11T09:12:51.000Z" title="发表于 2023-07-11 17:12:51">2023-07-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/kubernetes/">kubernetes</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/kubernetes/OpenKruise/">OpenKruise</a></span></div><div class="content">OpenKruise 是一个基于 Kubernetes 的扩展套件，主要聚焦于云原生应用的自动化，比如部署、发布、运维以及可用性防护。OpenKruise 提供的绝大部分能力都是基于 CRD 扩展来定义的，它们不存在于任何外部依赖，可以运行在任意纯净的 Kubernetes 集群中。Kubernetes 自身提供的一些应用部署管理功能，对于大规模应用与集群的场景这些功能是远远不够的，OpenKruise 弥补了 Kubernetes 在应用部署、升级、防护、运维等领域的不足。
OpenKruise 提供了以下的一些核心能力：

增强版本的 Workloads：OpenKruise 包含了一系列增强版本的工作负载，比如 CloneSet、Advanced StatefulSet、Advanced DaemonSet、BroadcastJob 等。它们不仅支持类似于 Kubernetes 原生 Workloads 的基础功能，还提供了如原地升级、可配置的扩缩容&#x2F;发布策略、并发操作等。其中，原地升级是一种升级应用容器镜像甚至环境变量的全新方式，它只会用新的镜像重建 Pod 中的特定 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/#content-inner">7</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/logo.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">姬岚忧</div><div class="author-info__description">不想做开发的运维，不是好运维</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Ghostpanter"><i class="fab fa-github"></i><span>Github</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Ghostpanter" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:18816230062qk@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/07/28/Kubernetes%20Pod%20%E4%B8%AD%E5%AE%B9%E5%99%A8%E7%9A%84%E5%90%AF%E5%8A%A8%E4%BC%98%E5%85%88%E7%BA%A7/" title="Kubernetes Pod 中容器的启动优先级"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301051001001.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes Pod 中容器的启动优先级"/></a><div class="content"><a class="title" href="/2023/07/28/Kubernetes%20Pod%20%E4%B8%AD%E5%AE%B9%E5%99%A8%E7%9A%84%E5%90%AF%E5%8A%A8%E4%BC%98%E5%85%88%E7%BA%A7/" title="Kubernetes Pod 中容器的启动优先级">Kubernetes Pod 中容器的启动优先级</a><time datetime="2023-07-28T09:54:33.000Z" title="发表于 2023-07-28 17:54:33">2023-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/28/%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86Docker%E5%AE%B9%E5%99%A8%E5%92%8CKubernetes%20Pod%E7%9A%84DNS/" title="如何管理 Docker 容器和 Kubernetes Pod 的 DNS"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301050959939.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何管理 Docker 容器和 Kubernetes Pod 的 DNS"/></a><div class="content"><a class="title" href="/2023/07/28/%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86Docker%E5%AE%B9%E5%99%A8%E5%92%8CKubernetes%20Pod%E7%9A%84DNS/" title="如何管理 Docker 容器和 Kubernetes Pod 的 DNS">如何管理 Docker 容器和 Kubernetes Pod 的 DNS</a><time datetime="2023-07-28T03:40:33.000Z" title="发表于 2023-07-28 11:40:33">2023-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/28/%E4%BC%98%E5%8C%96Kubernetes%20VPA%E7%9A%84%E5%8F%8D%E5%BA%94/" title="优化Kubernetes VPA的反应"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/75368085_p0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="优化Kubernetes VPA的反应"/></a><div class="content"><a class="title" href="/2023/07/28/%E4%BC%98%E5%8C%96Kubernetes%20VPA%E7%9A%84%E5%8F%8D%E5%BA%94/" title="优化Kubernetes VPA的反应">优化Kubernetes VPA的反应</a><time datetime="2023-07-28T02:40:33.000Z" title="发表于 2023-07-28 10:40:33">2023-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/28/Pod%20%E5%8E%9F%E5%9C%B0%E5%9E%82%E7%9B%B4%E4%BC%B8%E7%BC%A9/" title="Pod 原地垂直伸缩 - 一个四年的KEP和两年的PR"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/84596624_p0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Pod 原地垂直伸缩 - 一个四年的KEP和两年的PR"/></a><div class="content"><a class="title" href="/2023/07/28/Pod%20%E5%8E%9F%E5%9C%B0%E5%9E%82%E7%9B%B4%E4%BC%B8%E7%BC%A9/" title="Pod 原地垂直伸缩 - 一个四年的KEP和两年的PR">Pod 原地垂直伸缩 - 一个四年的KEP和两年的PR</a><time datetime="2023-07-28T01:50:33.000Z" title="发表于 2023-07-28 09:50:33">2023-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/28/CGroups%E4%BB%A5%E5%8F%8A%E5%9C%A8K8s%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-IO/" title="CGroups 以及在 K8s 中的应用 - IO"><img src="https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202301051001001.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CGroups 以及在 K8s 中的应用 - IO"/></a><div class="content"><a class="title" href="/2023/07/28/CGroups%E4%BB%A5%E5%8F%8A%E5%9C%A8K8s%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-IO/" title="CGroups 以及在 K8s 中的应用 - IO">CGroups 以及在 K8s 中的应用 - IO</a><time datetime="2023-07-28T01:40:33.000Z" title="发表于 2023-07-28 09:40:33">2023-07-28</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Ansible/"><span class="card-category-list-name">Ansible</span><span class="card-category-list-count">2</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Ansible/playbook/"><span class="card-category-list-name">playbook</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Ceph/"><span class="card-category-list-name">Ceph</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CubeFS/"><span class="card-category-list-name">CubeFS</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CubeFS/ClickHouse/"><span class="card-category-list-name">ClickHouse</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Docker/"><span class="card-category-list-name">Docker</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Linux/"><span class="card-category-list-name">Linux</span><span class="card-category-list-count">8</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Linux/DNS/"><span class="card-category-list-name">DNS</span><span class="card-category-list-count">1</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Ansible/" style="font-size: 1.25em; color: rgb(160, 24, 115)">Ansible</a><a href="/tags/playbook/" style="font-size: 1.15em; color: rgb(172, 149, 52)">playbook</a><a href="/tags/kubernetes/" style="font-size: 1.45em; color: rgb(31, 153, 87)">kubernetes</a><a href="/tags/CICD/" style="font-size: 1.2em; color: rgb(74, 134, 186)">CICD</a><a href="/tags/Gitlab/" style="font-size: 1.15em; color: rgb(165, 98, 68)">Gitlab</a><a href="/tags/CGroups/" style="font-size: 1.15em; color: rgb(143, 33, 110)">CGroups</a><a href="/tags/CoreDns/" style="font-size: 1.15em; color: rgb(186, 180, 27)">CoreDns</a><a href="/tags/CubeFS/" style="font-size: 1.15em; color: rgb(174, 10, 29)">CubeFS</a><a href="/tags/ClickHouse/" style="font-size: 1.15em; color: rgb(101, 151, 165)">ClickHouse</a><a href="/tags/Ceph/" style="font-size: 1.3em; color: rgb(22, 81, 40)">Ceph</a><a href="/tags/etcd/" style="font-size: 1.2em; color: rgb(56, 190, 180)">etcd</a><a href="/tags/Grafana/" style="font-size: 1.3em; color: rgb(41, 137, 182)">Grafana</a><a href="/tags/Tempo/" style="font-size: 1.2em; color: rgb(196, 2, 76)">Tempo</a><a href="/tags/Linux/" style="font-size: 1.4em; color: rgb(115, 54, 148)">Linux</a><a href="/tags/Jenkins/" style="font-size: 1.15em; color: rgb(65, 161, 119)">Jenkins</a><a href="/tags/Docker/" style="font-size: 1.35em; color: rgb(4, 112, 99)">Docker</a><a href="/tags/OpenKruise/" style="font-size: 1.3em; color: rgb(51, 59, 140)">OpenKruise</a><a href="/tags/MAC/" style="font-size: 1.15em; color: rgb(40, 75, 121)">MAC</a><a href="/tags/OpenCore/" style="font-size: 1.15em; color: rgb(158, 102, 118)">OpenCore</a><a href="/tags/Prometheus/" style="font-size: 1.15em; color: rgb(124, 36, 109)">Prometheus</a><a href="/tags/Helm/" style="font-size: 1.2em; color: rgb(46, 187, 193)">Helm</a><a href="/tags/ingress/" style="font-size: 1.2em; color: rgb(66, 167, 199)">ingress</a><a href="/tags/Harbor/" style="font-size: 1.25em; color: rgb(126, 123, 84)">Harbor</a><a href="/tags/Minio/" style="font-size: 1.2em; color: rgb(60, 29, 133)">Minio</a><a href="/tags/NFS/" style="font-size: 1.2em; color: rgb(112, 186, 187)">NFS</a><a href="/tags/kubectl/" style="font-size: 1.15em; color: rgb(62, 119, 49)">kubectl</a><a href="/tags/Kubelet/" style="font-size: 1.25em; color: rgb(96, 114, 131)">Kubelet</a><a href="/tags/Nginx/" style="font-size: 1.15em; color: rgb(27, 114, 153)">Nginx</a><a href="/tags/PDNS/" style="font-size: 1.15em; color: rgb(118, 6, 185)">PDNS</a><a href="/tags/PVE/" style="font-size: 1.15em; color: rgb(149, 16, 26)">PVE</a><a href="/tags/containerd/" style="font-size: 1.15em; color: rgb(55, 3, 115)">containerd</a><a href="/tags/GO/" style="font-size: 1.15em; color: rgb(41, 52, 134)">GO</a><a href="/tags/Kaniko/" style="font-size: 1.15em; color: rgb(105, 158, 138)">Kaniko</a><a href="/tags/Cilium/" style="font-size: 1.15em; color: rgb(123, 94, 197)">Cilium</a><a href="/tags/Kind/" style="font-size: 1.15em; color: rgb(11, 18, 191)">Kind</a><a href="/tags/opentracing/" style="font-size: 1.15em; color: rgb(98, 189, 129)">opentracing</a><a href="/tags/Mysql/" style="font-size: 1.15em; color: rgb(61, 147, 60)">Mysql</a><a href="/tags/Loki/" style="font-size: 1.2em; color: rgb(50, 75, 100)">Loki</a><a href="/tags/DNS/" style="font-size: 1.15em; color: rgb(148, 83, 43)">DNS</a><a href="/tags/Containerd/" style="font-size: 1.2em; color: rgb(196, 38, 84)">Containerd</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><span class="card-archive-list-count">12</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><span class="card-archive-list-count">18</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">十二月 2022</span><span class="card-archive-list-count">15</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">68</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2022-12-27T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">267.4k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-07-28T09:27:51.375Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/Ghostpanter/tuchuang/img/202212290952165.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 姬岚忧</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = []
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div><div class="aplayer no-destroy" data-id="8017562763" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '119.60681,31.99260';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>